var srch={};srch.input=$("#search-input"),srch.form=$("#search-banner form"),srch.formbtn=$('#search-banner form button[type="submit"]'),srch.results=$("#searchResults"),srch.resultcts=$("#results > div"),srch.tabslinks=$("#searchTabs li a"),srch.servicesList=$("#servicesList"),srch.formsResults=$("#formsResults"),srch.googleResults=$("#googleResults"),srch.relatedResults=$("#relatedResults"),srch.agencyList=$("#agency"),srch.trendingList=$("#trending"),srch.youtubeList=$("#youtube"),srch.clrbtn=$("button.clear-search"),srch.len="",srch.keyword="",srch.delaytimeout="",srch.delaytime=2500,srch.ready=!1,srch.tabs={open:function(tab,tabdata){srch.tabs.closeall(),"servicesList"==tabdata&&srch.servicesList.addClass("search-panel-active"),"formsResults"==tabdata&&(srch.cse.forms(),srch.formsResults.addClass("search-panel-active")),"googleResults"==tabdata&&(srch.cse.all(),srch.googleResults.addClass("search-panel-active")),"relatedResults"==tabdata&&srch.relatedResults.addClass("search-panel-active"),tab.addClass("active")},close:function(tab,tabdata){tab.removeClass("active")},closeall:function(){srch.tabslinks.removeClass("active"),srch.servicesList.removeClass("search-panel-active"),srch.formsResults.removeClass("search-panel-active"),srch.googleResults.removeClass("search-panel-active"),srch.relatedResults.removeClass("search-panel-active")}},srch.init=function(){1==srch.ready&&srch.run_search()},srch.run_search=function(){srch.len=srch.input.val().length,srch.keyword=srch.escout(srch.input.val()),srch.len>2?(srch.mod.open(),srch.get_services(),srch.output_querytext(),srch.delay("youtube"),srch.output_twitter(),srch.tabs.open($("#servicesTab a"),"servicesList")):srch.mod.close()},srch.delay=function(fn){clearTimeout(srch.delaytimeout),srch.delaytimeout=setTimeout(function(){"youtube"==fn&&srch.output_youtube(),"twitter"==fn&&srch.output_twitter()},srch.delaytime)},srch.output_querytext=function(get){$('[data-getquery="true"]').each(function(i){$(this).html(srch.keyword)})},srch.get_services=function(){var args={};args.agencymapsize=srch.agencyList.data("mapsize"),args.type=srch.servicesList.data("type"),args.keyword=srch.escout(srch.keyword),args.limit=srch.servicesList.data("limit"),args.html="",args.count="",args.agency="",$.getJSON(mdi.url,{keyword:args.keyword,typeIds:args.type,limit:args.limit},function(data){args.agency=data.topAgency,null!=args.agency&&srch.output_topagency(data,args),srch.output_trending(args),args.count=data.totalCount,srch.output_services(data,args)})},srch.output_services=function(data,args){args.html+='<ul class="my-new-list">',0!=args.count?$.each(data.results,function(i,result){args.html+='<li class="item '+result.type+" "+result.governmentClass+'">',result.url&&(args.html+='<a href="'+result.url+'">'),result.name&&(args.html+='<h4 class="title">'+result.name+"</h4>"),result.agencies[0]&&(args.html+='<span class="agency">'+result.agencies[0]+"</span>"),result.description&&(args.html+='<span class="description">'+result.description+"</span>"),result.url&&(args.html+="</a>"),args.html+="</li>"}):(args.html+='<li class="item noresults">',args.html+='<a href=#googleResults" class="getgoogleresults">',args.html+='<h4 class="title">No Services results found with search term: "'+srch.keyword+'"</h4>',args.html+='<span class="description">Try Searching "All Of Utah.gov"</span>',args.html+="</a>",args.html+="</li>"),args.html+="</ul>",srch.servicesList.html(args.html)},srch.output_topagency=function(data,args){var agency=args.agency;if(agency){var agencyhtml='<a href="https://maps.google.com/maps?f=q&amp;source=s_q&amp;hl=en&amp;geocode=&amp;q='+agency.street1+" "+agency.city+" Utah "+agency.zip+'" class="agency-map">';agencyhtml+='<img alt="'+agency.name+'" src="https://maps.google.com/maps/api/staticmap?center='+agency.street1+" "+agency.city+" Utah "+agency.zip+"&amp;zoom=13&amp;size="+args.agencymapsize+"x"+args.agencymapsize+'">',agencyhtml+="</a>",agencyhtml+="<h4>"+agency.name+"</h4>",agencyhtml+='<p class="agency-address">',agencyhtml+=agency.street1+" "+agency.street2+"<br>",agencyhtml+=agency.city+", Utah "+agency.zip+"<br>",agencyhtml+='<span class="agency-phone">'+agency.phone+"</span>",agencyhtml+="</p>",srch.agencyList.html(agencyhtml),srch.agencyList.addClass("active")}else srch.agencyList.removeClass("active")},srch.output_trending=function(args){$.getJSON(mdi.url,{keyword:args.keyword,typeIds:54,limit:1},function(data){var result=data.results[0],trendinghtml="";result?(trendinghtml='<a href="'+result.url+'">'+result.description+"</a>",srch.trendingList.addClass("active")):(trendinghtml="",srch.trendingList.removeClass("active")),srch.trendingList.html(trendinghtml)})},srch.output_youtube=function(){var ytContainer=document.getElementById("youtube");YTchannelId="UCkjGDFkwdRkRjyyykSkumew",YTapikey="AIzaSyDSUZ02zh9A4w5neKOb__JElQJRmtnPAUM",srch.escout(srch.keyword).length>2&&$.getJSON("https://www.googleapis.com/youtube/v3/search",{part:"snippet",q:srch.escout(srch.keyword),channelId:YTchannelId,maxResults:3,key:YTapikey},function(data){for(var yhtml="<ul>",i=0;i<data.items.length;i++){var ytWaId=data.items[i].id.videoId,ytPlId=data.items[i].id.playlistId,ytLink="";ytWaId?ytLink="https://www.youtube.com/watch?v="+ytWaId:ytPlId&&(ytLink="https://www.youtube.com/playlist?list="+ytPlId);var ytTitle=data.items[i].snippet.title;yhtml+="<li>",yhtml+='<a href="'+ytLink+'" target="_blank" style="background-image: url('+data.items[i].snippet.thumbnails.default.url+')" title="'+ytTitle+'">'+ytTitle+"</a>",yhtml+="</li>"}yhtml+="</ul>",ytContainer.innerHTML=yhtml})},srch.output_twitter=function(keyword){var tweets=document.getElementById("tweets");document.getElementById("tweetsNo");if(srch.escout(srch.keyword).length>2){$.getJSON("/aggregator/tweetsForList.json",{listOwner:"UtahGov",slug:"utah-government",count:5,keyword:srch.escout(srch.keyword)},function(tweetData){for(var twhtml="",i=0;i<tweetData.length;i++){var tweetUrl=tweetData[i].url,tweetPost=tweetData[i].post;twhtml+='<a href="'+tweetUrl+'" title="'+tweetPost+'" target="_blank" class="tweetLink">',twhtml+='\t<span class="tweetPost">'+tweetPost+"</span>",twhtml+='\t<span class="tweetAuthor">'+tweetData[i].author+"</span>",twhtml+='\t<span class="tweetDate">'+tweetData[i].createdDate+"</span>",twhtml+="</a>"}tweets.innerHTML=twhtml})}},srch.mod={open:function(){srch.input.parent("p").addClass("search-ajax-active"),srch.results.addClass("search-ajax-active")},close:function(){srch.input.parent("p").removeClass("search-ajax-active"),srch.results.removeClass("search-ajax-active")},reset:function(){1==srch.kgb.active?(srch.kgb.act.halt(),srch.kgb.act.start()):(srch.input.val(""),srch.init(),srch.input.blur())}},srch.cse={forms:function(){srch.formsResults.html('<iframe scrolling="yes" id="form-results" frameborder="0" src="/gse/forms.html?q='+srch.keyword+'"></iframe>')},all:function(){srch.googleResults.html('<iframe scrolling="yes" id="google-results" frameborder="0" src="/gse/all.html?q='+srch.keyword+'"></iframe>')}},srch.escout=function(string){var entitymap={"&":"&amp;","<":"&lt;",">":"&gt;","/":"&#x2F;"};return String(string).replace(/[&<>"'\/]/g,function(s){return entitymap[s]})},srch.kgb={},srch.kgb.startdelay=1500,srch.kgb.restartdelay=4e3,srch.kgb.timer=7e3,srch.kgb.fadetimer=srch.kgb.timer-1e3,srch.kgb.container=$("#search-banner"),srch.kgb.txt="",srch.kgb.txtLen="",srch.kgb.typetimeout="",srch.kgb.bgtimeout="",srch.kgb.fadetimeout="",srch.kgb.restarttimeout="",srch.kgb.char="",srch.kgb.words=srch.input.data("keywords"),srch.kgb.active=!0,srch.kgb.rotatecount=0,srch.kgb.preload=function(){for(var images=srch.kgb.words,i=images.length-1;i>=0;i--){var imgfix="images/home/slider.jpg";(new Image).src=imgfix}},srch.kgb.preload(),srch.kgb.typeit=function(){var humanize=Math.round(170*Math.random())+30;srch.kgb.typetimeout=setTimeout(function(){if(srch.input.is(":focus"))return srch.input.val(""),!1;srch.kgb.char++;var type=srch.kgb.txt.substring(0,srch.kgb.char);srch.input.val(type+"|"),srch.kgb.typeit(),srch.kgb.char==srch.kgb.txtLen&&(srch.input.val(srch.input.val().slice(0,-1)),clearTimeout(srch.kgb.typetimeout),humanize=0)},humanize)},srch.kgb.reinit=function(){srch.kgb.txt=srch.input.val(),srch.kgb.txtLen=srch.kgb.txt.length,srch.kgb.typetimeout=null,srch.kgb.char=0,srch.input.val("|"),srch.kgb.typeit()},srch.kgb.change=function(){function fixImgUrl(keyword){return keyword=keyword.replace(/\s+/g,"")}function imgFade(){srch.kgb.container.addClass("fade")}srch.kgb.wordcount=srch.kgb.words.length,1==srch.kgb.active&&function KGBrotate(){srch.kgb.rotatecount<[srch.kgb.wordcount]&&1==srch.kgb.active?(srch.input.val(srch.kgb.words[srch.kgb.rotatecount]),srch.kgb.container.css("background-image",'url("images/home/slider.jpg")'),srch.kgb.container.attr("data-keyword",srch.kgb.words[srch.kgb.rotatecount]),srch.kgb.rotatecount=srch.kgb.rotatecount+1,srch.kgb.reinit(),clearTimeout(srch.kgb.bgtimeout),srch.kgb.bgtimeout=setTimeout(KGBrotate,srch.kgb.timer),clearTimeout(srch.kgb.fadetimeout),srch.kgb.fadetimeout=setTimeout(imgFade,srch.kgb.fadetimer)):1==srch.kgb.active&&(srch.kgb.rotatecount=0,srch.input.val(srch.kgb.words[srch.kgb.rotatecount]),srch.kgb.container.css("background-image",'url("images/home/slider.jpg")'),srch.kgb.container.attr("data-keyword",srch.kgb.words[srch.kgb.rotatecount]),srch.kgb.rotatecount=srch.kgb.rotatecount+1,srch.kgb.reinit(),clearTimeout(srch.kgb.bgtimeout),srch.kgb.bgtimeout=setTimeout(KGBrotate,srch.kgb.timer),clearTimeout(srch.kgb.fadetimeout),srch.kgb.fadetimeout=setTimeout(imgFade,srch.kgb.fadetimer)),srch.kgb.container.removeClass("fade")}()},srch.kgb.act={halt:function(){clearTimeout(srch.kgb.restarttimeout),clearTimeout(srch.kgb.typetimeout),clearTimeout(srch.kgb.bgtimeout),1==srch.kgb.active&&(srch.input.val(""),srch.input.attr("placeholder","")),srch.kgb.active=!1,srch.ready=!0,srch.kgb.container.addClass("fade")},start:function(){0==srch.input.val().length&&(srch.kgb.restarttimeout=setTimeout(function(){srch.kgb.active=!0,srch.ready=!1,srch.kgb.change(),srch.input.attr("placeholder",""),srch.mod.close()},srch.kgb.restartdelay))},srchsubmit:function(){1==srch.kgb.active?(srch.kgb.act.halt(),srch.input.val(srch.kgb.words[srch.kgb.rotatecount-1]),srch.form.submit()):0==srch.kgb.active&&srch.form.submit()}},$(function(){srch.input.focus(function(event){srch.kgb.act.halt(),srch.init()}),srch.input.blur(function(event){srch.kgb.act.start()}),srch.formbtn.click(function(event){srch.kgb.act.srchsubmit()}),srch.input.keyup(function(e){13==e.keyCode&&srch.kgb.act.srchsubmit()}),srch.clrbtn.click(function(event){srch.mod.reset()}),setTimeout(function(){srch.kgb.change()},srch.kgb.startdelay),srch.input.keyup(function(){srch.init()}),srch.tabslinks.click(function(event){var tabdata=$(this).data("tab");$(this).hasClass("active")||srch.tabs.open($(this),tabdata),event.preventDefault()}),$("body").on("click",".getgoogleresults",function(event){srch.tabs.open($('[data-tab="googleResults"]'),"googleResults"),event.preventDefault()})});
//# sourceMappingURL=search.min.js.map
